"use strict";angular.module("csmApp",["ngRoute","csm.datamart","csm.headernavbar","csm.customthemer","csm.custompanel","csm.highcharts","d3","ngLodash","highcharts-ng","ui.grid","ui.grid.grouping","ui.grid.pagination"]).config(["$routeProvider","DatamartProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/global/:id",{templateUrl:"views/global.html",controller:"GlobalCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("d3",[]).service("d3Service",[function(){return window.d3}]),angular.module("csm.datamart",[]).provider("Datamart",[function(a,b){var c={};c.init=function(a,b){a.configuration=b,b.baseUrl=angular.isDefined(b.baseUrl)?b.baseUrl:"rawdata/",a.setBaseUrl=function(a){return b.baseUrl=/\/$/.test(a)?a.substring(0,a.length-1):a,this},b.incidentFile=b.incidentFile||"incdata.csv",a.setIncidentFile=function(a){return b.incidentFile=a,this},b.taskFile=b.taskFile||"taskdata.csv",a.setTaskFile=function(a){return b.taskFile=a,this}};var d={};c.init(this,d),this.$get=["$q",function(a){function b(b){function d(a){var b=1;return g.map(a,function(a,c){return b=b++,{name:c,id:c+Math.floor(20*Math.random())+1,data:g.map(a,function(a,b){return[b,a]})}})}function e(){var c=a.defer();return h.csv(b.baseUrl+b.incidentFile,function(a){a.forEach(function(a,b){a.rowIndex=b,a.id=b}),c.resolve(a)}),c.promise}function f(){var c=a.defer();return h.csv(b.baseUrl+b.taskFile,function(a){a.forEach(function(a,b){a.rowIndex=b,a.id=b}),c.resolve(a)}),c.promise}var g=window._,h=window.d3,i={};return c.init(i,b),i.incidentData=g.bind(e,i),i.taskData=g.bind(f,i),i.formatData=d,i}return b(d)}]}]),angular.module("csm.headernavbar",[]).controller("HeaderNavCtrl",["$scope",function(a){var b=this;b.activePage=function(b){a.activepage=b},b.tooglermsg="Click to toggle sidebar menu",a.$on("initialize",function(){angular.element('[data-toggle="tooltip"]').tooltip()})}]).directive("headerNavbar",["lodash","$rootScope",function(a,b){var c=window.$;return{controller:"HeaderNavCtrl",controllerAs:"hnc",templateUrl:"views/tmpl/headernav.html",restrict:"A",transclude:!0,replace:!0,link:function(d,e,f,g){b.$broadcast("initialize"),e.bind("click",function(b){0!==angular.element(".boxlinked.on").length&&setTimeout(function(){var a=c(".charts").height(),b=c(".charts").width(),d=c(".charts").highcharts();d.setSize(b,a,!0),d.reflow()},300),"toggler"===b.target.id||"toggler"===b.target.parentElement.id?angular.element("body").toggleClass("sidebar-collapse"):a.has(b.target.attributes,"ng-href")&&g.activePage(b.target.text.toLowerCase())})}}}]),angular.module("csm.customthemer",[]).controller("CsmThemerCtrl",["$scope","$document",function(a,b){var c=this;c.themermsg="Click to change theme.",c.fallback='<link rel="stylesheet" href="http://bootswatch.com/default/bootstrap-responsive.min.css"></link>',c.themes=["rykn0wxx","Cerulean","Cosmo","Darkly","Flatly","Lumen","Paper","Sandstone","Cyborg","Journal","Readable","Simplex","Slate","Spacelab","Spruce","Superhero","United","Yeti"],a.change=function(){b.find("link.bootswatcher")[0]||b.find("head").append('<link rel="stylesheet" class="bootswatcher">'),b.find("link.bootswatcher").attr("href","http://bootswatch.com/"+a.selectedTheme.toLowerCase()+"/bootstrap.min.css")},a.$on("initialize",function(){angular.element('[data-toggle="tooltip"]').tooltip()})}]).directive("csmThemer",["$rootScope",function(a){return{controller:"CsmThemerCtrl",controllerAs:"bslet",template:'<div class="holder" data-toggle="tooltip" data-placement="left" data-original-title="{{bslet.themermsg}}"><select class="bootswatcher" ng-change="change()" ng-model="selectedTheme" ng-options="t for t in bslet.themes"></select></div>',transclude:!0,restrict:"E",replace:!0,link:function(){a.$broadcast("initialize")}}}]),angular.module("csm.custompanel",[]).directive("csmPanels",["$rootScope",function(a){function b(a){var b="home"===a?0:1;angular.element(".on").addClass("off"),angular.element(".off").removeClass("on").delay(500).queue(function(a){angular.element(this).addClass("display-none"),angular.element(".home-back").css("opacity",b),a()}),angular.element("."+a).removeClass("off").delay(0).queue(function(a){angular.element(this).addClass("on"),angular.element(this).removeClass("display-none"),a()})}function c(c,e,f){c.iconList=["hand-rock-o","phone","desktop","cubes"],e.bind("click",function(e){var f=d.intersection(e.target.classList,d.map(c.paneldata,function(a){return a+"-link-box"})),g=d.intersection(void 0===angular.element(e.target).parents(".box")[0]?[]:angular.element(e.target).parents(".box")[0].classList,d.map(c.paneldata,function(a){return a+"-link-box"})),h=d.intersection(void 0===angular.element(e.target).parents(".home-back")[0]?[]:angular.element(e.target).parents(".home-back")[0].classList,c.paneldata),i=0!==f.length?f:0!==g.length?g:h;if(0!==i.length){var j=d.split(i[0],"-",1).toString();b(d.split(i[0],"-",1).toString()),"home"!==d.split(i[0],"-",1).toString()&&a.$broadcast("panelselected",j)}})}var d=window._;return{restrict:"A",transclude:!0,replace:!0,scope:{paneldata:"=",selectedpanel:"="},templateUrl:"views/tmpl/csmpanel.html",link:c}}]),angular.module("csm.highcharts",[]).directive("hcStackedcolumn",[function(){return{template:'<highchart id="chart1" config="chartConfig" class="chart" ></highchart>',restrict:"A",replace:!0,scope:{chartdata:"="},link:function(a,b,c){b.text("this is the hcCharts directive")}}}]),angular.module("csmApp").controller("MainCtrl",["$scope","$timeout","Datamart",function(a,b,c){function d(a){var b=1;return e.map(a,function(a,c){return b=b++,{name:c,type:"",id:c,data:e.map(a,function(a,b){return[b,a]})}})}var e=window._,f=(window.$,window.d3),g=window.Highcharts;a.panelarray=["home-back","servicedesk","deskside","baseservices"],a.chartTypes=[{id:"line",title:"Line"},{id:"spline",title:"Smooth line"},{id:"area",title:"Area"},{id:"areaspline",title:"Smooth area"},{id:"column",title:"Column"},{id:"bar",title:"Bar"},{id:"pie",title:"Pie"},{id:"scatter",title:"Scatter"}],a.dashStyles=[{id:"Solid",title:"Solid"},{id:"ShortDash",title:"ShortDash"},{id:"ShortDot",title:"ShortDot"},{id:"ShortDashDot",title:"ShortDashDot"},{id:"ShortDashDotDot",title:"ShortDashDotDot"},{id:"Dot",title:"Dot"},{id:"Dash",title:"Dash"},{id:"LongDash",title:"LongDash"},{id:"DashDot",title:"DashDot"},{id:"LongDashDot",title:"LongDashDot"},{id:"LongDashDotDot",title:"LongDashDotDot"}],a.chartSeries=[{name:"Chat",id:"Chat",type:"column",data:[["2015 Jun",158],["2015 Jul",156],["2015 Aug",171],["2015 Sep",155],["2015 Oct",204],["2015 Nov",183],["2015 Dec",140],["2016 Jan",197],["2016 Feb",126],["2016 Mar",145],["2016 Apr",172],["2016 May",166],["2016 Jun",200]]},{name:"Email",id:"Email",type:"column",data:[["2015 Jun",7],["2015 Jul",13],["2015 Aug",10],["2015 Sep",21],["2015 Oct",15],["2015 Nov",9],["2015 Dec",12],["2016 Jan",16],["2016 Feb",31],["2016 Mar",16],["2016 Apr",27],["2016 May",5],["2016 Jun",7]]},{name:"Phone",id:"Phone",type:"column",data:[["2015 Jun",2028],["2015 Jul",2104],["2015 Aug",1932],["2015 Sep",2174],["2015 Oct",1891],["2015 Nov",1858],["2015 Dec",1800],["2016 Jan",1880],["2016 Feb",1748],["2016 Mar",1904],["2016 Apr",1718],["2016 May",1827],["2016 Jun",2009]]},{name:"Self-service",id:"Self-service",type:"column",data:[["2015 Jun",372],["2015 Jul",393],["2015 Aug",424],["2015 Sep",388],["2015 Oct",383],["2015 Nov",362],["2015 Dec",292],["2016 Jan",408],["2016 Feb",403],["2016 Mar",412],["2016 Apr",376],["2016 May",372],["2016 Jun",467]]},{name:"Walk-in",id:"Walk-in",type:"column",data:[["2015 Jul",2],["2015 Aug",3],["2015 Sep",2],["2015 Oct",2],["2015 Nov",1],["2016 Jan",2],["2016 Mar",1],["2016 Apr",5],["2016 May",4],["2016 Jun",5]]}],a.chartStack=[{id:"",title:"No"},{id:"normal",title:"Normal"},{id:"percent",title:"Percent"}],a.addPoints=function(){var b=a.chartConfig.series,c=Math.floor(Math.random()*b.length);b[c].data=b[c].data.concat([1,10,20])},a.addSeries=function(b){for(var c=[],g=0;10>g;g++)c.push(Math.floor(20*Math.random())+1);a.chartConfig.series=b;var h=[];h=e.filter(a.incdata,["desk",b]),h=f.nest().key(function(a){return a.contact_type}).key(function(a){return a.monthnum}).rollup(function(a){return f.sum(a,function(a){return parseFloat(a.ctr)})}).map(h),h=d(h)},a.changeSeries=function(g){c.incidentData().then(function(c){var h=[];h=e.filter(c,["desk",g]),h=f.nest().key(function(a){return a.contact_type}).key(function(a){return a.monthnum}).rollup(function(a){return f.sum(a,function(a){return parseFloat(a.ctr)})}).map(h),h=d(h),a.chartConfig.title.text=g,a.chartSeries=h,a.chartConfig.series=a.chartSeries,b(function(){var a=angular.element("."+g),b=angular.element(".charts"),c=b.highcharts();c.setSize(b.width(),a.height(),!0),c.reflow()},500)})},a.removeRandomSeries=function(){var b=a.chartConfig.series,c=Math.floor(Math.random()*b.length);b.splice(c,1)},a.removeSeries=function(b){var c=a.chartConfig.series;c.splice(b,1)},a.toggleHighCharts=function(){this.chartConfig.useHighStocks=!this.chartConfig.useHighStocks},a.replaceAllSeries=function(){var b=[{name:"Some data",data:[["a",5],["b",2],["c",2],["d",3],["e",5]],id:"series-0"},{name:"Some data 2",data:[["a",4],["b",1],["c",10],["d",2],["e",3]],type:"column",id:"series-2"}];a.chartConfig.series=b},a.chartConfig={options:{chart:{type:"column"},plotOptions:{series:{stacking:"normal"}},xAxis:{type:"category"},yAxis:{title:{text:"Volume"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:g.theme&&g.theme.textColor||"gray"}},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>Total: {point.stackTotal}"}}},series:a.chartSeries,title:{text:"Hello"},credits:{enabled:!0},loading:!1,size:{}},a.reflow=function(){a.$broadcast("highchartsng.reflow")},a.$on("panelselected",function(b,c){a.changeSeries(c)})}]),angular.module("csmApp").controller("AboutCtrl",["$scope","Datamart","uiGridGroupingConstants","uiGridConstants",function(a,b,c,d){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"];a.gridOptions={paginationPageSizes:[25,50,75],paginationPageSize:25,useExternalPagination:!0,useExternalSorting:!0,treeRowHeaderAlwaysVisible:!1},a.gridOptions={},a.gridOptions.data="myData",a.gridOptions.enableColumnResizing=!0,a.gridOptions.enableFiltering=!0,a.gridOptions.enableGridMenu=!0,a.gridOptions.showGridFooter=!0,a.gridOptions.showColumnFooter=!0,a.gridOptions.fastWatch=!0,a.gridOptions.columnDefs=[{field:"monthnum",displayName:"Month",grouping:{groupPriority:0}},{field:"groupname",displayName:"Group"},{field:"contact_type"},{field:"location"},{field:"ctr",displayName:"Volume"}],a.gridOptions.rowIdentity=function(a){return a.id},a.gridOptions.getRowIdentity=function(a){return a.id},b.incidentData().then(function(b){a.myData=_.filter(b,["desk","servicedesk"]),console.log(a.myData)})}]),angular.module("csmApp").controller("GlobalCtrl",["$scope","$routeParams","$timeout","Datamart",function(a,b,c,d){function e(a){var b=1;return f.map(a,function(a,c){return b=b++,{name:c,type:"",id:c,data:f.map(a,function(a,b){return[b,a]})}})}var f=window._,g=(window.$,window.d3),h=window.Highcharts;a.contentheader=f.upperFirst(b.id),a.panelarray=["home-back","servicedesk","deskside","baseservices"],a.chartTypes=[{id:"line",title:"Line"},{id:"spline",title:"Smooth line"},{id:"area",title:"Area"},{id:"areaspline",title:"Smooth area"},{id:"column",title:"Column"},{id:"bar",title:"Bar"},{id:"pie",title:"Pie"},{id:"scatter",title:"Scatter"}],a.chartSeries=[],a.rawdata=[],a.chartStack=[{id:"",title:"No"},{id:"normal",title:"Normal"},{id:"percent",title:"Percent"}],a.changeSeries=function(h){var i,j=[],k=[];i="incident"===b.id?d.incidentData():d.taskData(),i.then(function(d){k=f.filter(d,["desk",h]),j=g.nest().key(function(a){return"incident"===b.id?a.contact_type:a.region}).key(function(a){return a.monthnum}).rollup(function(a){return g.sum(a,function(a){return parseFloat(a.ctr)})}).map(k),j=e(j),a.chartConfig.title.text=h,a.chartSeries=j,a.chartConfig.series=a.chartSeries,a.rawdata=k,c(function(){var a=angular.element("."+h),b=angular.element(".charts"),c=b.highcharts();c.setSize(b.width(),a.height(),!0),c.reflow()},500)})},a.chartConfig={options:{chart:{type:"column"},plotOptions:{series:{stacking:"normal"}},xAxis:{type:"category"},yAxis:{title:{text:"Volume"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:h.theme&&h.theme.textColor||"gray"}},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>Total: {point.stackTotal}"}}},series:a.chartSeries,title:{text:"Hello"},credits:{enabled:!0},loading:!1,size:{}},a.reflow=function(){a.$broadcast("highchartsng.reflow")},a.$on("panelselected",function(b,c){a.changeSeries(c)})}]),angular.module("csmApp").run(["$templateCache",function(a){a.put("views/about.html",'<div> <section class="content-header"> <h3 class="page-header">Global Reporting <small>Tables</small> </h3> </section> <section class="content"> <div id="grid1" ui-grid="gridOptions" ui-grid-pagination ui-grid-grouping class="grid"></div> </section> </div>'),a.put("views/global.html",'<div> <section class="content-header"> <h3 class="page-header">Global Reporting <small>{{contentheader}} Ticket Reporting</small> </h3> </section> <section class="content"> <div csm-panels paneldata="panelarray"></div> <div class="row"> <div class="servicedesk deskside baseservices boxlinked wrap-content off display-none"> <div class="row no-mar"> <div class="col-sm-8 no-pad"> <div class="row no-mar"> <highchart id="csmchart1" config="chartConfig" class="charts"></highchart> </div> </div> <div class="col-sm-4 pd1"> <div class="bx bx-default bx-solid"> <div class="bx-header with-border"> <h3 class="bx-title">Main Chart Control</h3> <div class="bx-tools pull-right"> <button type="button" class="btn btn-box-tool" data-widget="collapse"> <i class="fa fa-minus"></i> </button> </div> </div> <div class="bx-body"> <div class="form-horizontal"> <div class="form-group"> <label class="col-sm-4 control-label">Chart</label> <div class="col-sm-8 pd01505"><input class="form-control input-sm" ng-model="chartConfig.title.text"></div> </div> <div class="form-group"> <label class="col-sm-4 control-label">Default Type</label> <div class="col-sm-8 pd01505"><select class="form-control input-sm" ng-model="chartConfig.options.chart.type" ng-options="t.id as t.title for t in chartTypes"></select></div> </div> <div class="form-group"> <label class="col-sm-4 control-label">Stack</label> <div class="col-sm-8 pd01505"><select class="form-control input-sm" ng-model="chartConfig.options.plotOptions.series.stacking" ng-options="t.id as t.title for t in chartStack"></select></div> </div> </div> </div> </div> <div class="bx bx-info bx-solid collapsed-box" ng-repeat="ser in chartSeries"> <div class="bx-header with-border"> <h3 class="bx-title">{{ser.name}}</h3> <div class="bx-tools pull-right"> <button type="button" class="btn btn-box-tool" data-widget="collapse"> <i class="fa fa-plus"></i> </button> </div> </div> <div class="bx-body"> <div class="form-horizontal"> <div class="form-group"> <label class="col-sm-4 control-label">Type</label> <div class="col-sm-8 pd01505"><select class="form-control input-sm" ng-model="ser.type" ng-options="t.id as t.title for t in chartTypes"></select></div> </div> <div class="form-group"> <label class="col-sm-4 control-label">Color</label> <div class="col-sm-8 pd01505"><input class="form-control input-sm" ng-model="ser.color"></div> </div> <div class="form-group"> <label class="col-sm-4 control-label">Line</label> <div class="col-sm-8 pd01505"><input class="form-control input-sm" ng-model="ser.lineWidth"></div> </div> </div> </div> </div> </div> </div> </div> </div> </section> </div>'),a.put("views/main.html",'<div> <section class="content-header"> <h3 class="page-header">Global Reporting <small>Main Content</small> </h3> </section> <section class="content"> <div csm-panels paneldata="panelarray"></div> <div class="row"> <div class="servicedesk deskside baseservices boxlinked wrap-content off display-none"> <div class="row no-mar"> <div class="col-sm-8 no-pad"> <div class="row no-mar"> <highchart id="csmchart1" config="chartConfig" class="charts"></highchart> </div> </div> <div class="col-sm-4 pd1"> <div class="bx bx-default bx-solid"> <div class="bx-header with-border"> <h3 class="bx-title">Main Chart Control</h3> <div class="bx-tools pull-right"> <button type="button" class="btn btn-box-tool" data-widget="collapse"> <i class="fa fa-minus"></i> </button> </div> </div> <div class="bx-body"> <div class="form-horizontal"> <div class="form-group"> <label class="col-sm-4 control-label">Chart</label> <div class="col-sm-8 pd01505"><input class="form-control input-sm" ng-model="chartConfig.title.text"></div> </div> <div class="form-group"> <label class="col-sm-4 control-label">Default Type</label> <div class="col-sm-8 pd01505"><select class="form-control input-sm" ng-model="chartConfig.options.chart.type" ng-options="t.id as t.title for t in chartTypes"></select></div> </div> <div class="form-group"> <label class="col-sm-4 control-label">Stack</label> <div class="col-sm-8 pd01505"><select class="form-control input-sm" ng-model="chartConfig.options.plotOptions.series.stacking" ng-options="t.id as t.title for t in chartStack"></select></div> </div> </div> </div> </div> <div class="bx bx-info bx-solid collapsed-box" ng-repeat="ser in chartSeries"> <div class="bx-header with-border"> <h3 class="bx-title">{{ser.name}}</h3> <div class="bx-tools pull-right"> <button type="button" class="btn btn-box-tool" data-widget="collapse"> <i class="fa fa-plus"></i> </button> </div> </div> <div class="bx-body"> <div class="form-horizontal"> <div class="form-group"> <label class="col-sm-4 control-label">Type</label> <div class="col-sm-8 pd01505"><select class="form-control input-sm" ng-model="ser.type" ng-options="t.id as t.title for t in chartTypes"></select></div> </div> <div class="form-group"> <label class="col-sm-4 control-label">Color</label> <div class="col-sm-8 pd01505"><input class="form-control input-sm" ng-model="ser.color"></div> </div> <div class="form-group"> <label class="col-sm-4 control-label">Line</label> <div class="col-sm-8 pd01505"><input class="form-control input-sm" ng-model="ser.lineWidth"></div> </div> </div> </div> </div> </div> </div> </div> </div> </section> </div>'),a.put("views/tmpl/csmpanel.html",'<div class="row"> <section class="backbox"> <div class="home-back"> <span class="fa fa-arrow-left"> Back</span> </div> </section> <section class="home wrap-content on"> <div class="row"> <div class="col-sm-4 pd1" ng-repeat="pd in paneldata" ng-if="!$first"> <div class="box box-profile {{pd}}-link-box color{{$index}}"> <div class="mask"></div> <p class="title">{{pd}}</p> <span class="fa fa-5x fa-{{iconList[$index]}}"></span> </div> </div> </div> </section> </div>'),a.put("views/tmpl/headernav.html",'<div class="container-fluid" ng-init="hnc.activepage=\'home\'"> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbartarget" aria-expanded="false" aria-controls="navbartarget"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a id="toggler" class="navbar-brand" href="javascript:void(0)" data-toggle="tooltip" data-placement="right" title="" data-original-title="{{hnc.tooglermsg}}"> <i class="fa fa-navicon"></i> </a> </div> <div class="navbar-collapse collapse" id="navbartarget" aria-expanded="false" style="height: 1px"> <ul class="nav navbar-nav {{hnc.activepage}}"> <li class="home"><a ng-href="#/" ng-click="hnc.activepage =\'home\'">Home</a></li> <li class="about"><a ng-href="#/about" ng-click="hnc.activepage =\'about\'">About </a></li> </ul> <!-- 		<div totem-ticker class="ticker">\r\n			<strong>Updates: </strong>\r\n			<ul>\r\n				<li>Service desk reporting</li>\r\n				<li>Deskside reporting</li>\r\n				<li>Base services reporting</li>\r\n				<li>Global Stefanini Novelis QBR</li>\r\n			</ul>\r\n		</div> --> <ul class="nav navbar-nav navbar-right"> <li><csm-themer></csm-themer></li> <li><a href="#">Link</a></li> </ul> </div> </div>')}]);